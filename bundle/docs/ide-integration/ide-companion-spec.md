# Специфікація супутнього плагіна Gemini CLI

Це технічний документ, що визначає контракт для створення плагінів до різних IDE
(JetBrains, Sublime Text тощо) для підтримки режиму інтеграції з Gemini CLI.

## I. Інтерфейс взаємодії

CLI та плагін IDE взаємодіють через локальний канал зв'язку.

### 1. Транспортний рівень: MCP через HTTP

Плагін **ПОВИНЕН** запустити локальний HTTP-сервер, що реалізує **Model Context
Protocol (MCP)**.

- Сервер повинен працювати на динамічному порту (порт `0`).

### 2. Механізм виявлення: Файл порту

Щоб CLI міг підключитися, він повинен знати, у якому екземплярі IDE він
запущений. Плагін має створити файл у папці `os.tmpdir()/gemini/ide/`.

- **Назва файлу:** `gemini-ide-server-${PID}-${PORT}.json`
- **Вміст:** JSON-об'єкт із портом сервера, шляхом до робочого простору
  (`workspacePath`) та токеном аутентифікації (`authToken`).

## II. Інтерфейс контексту

Плагін може надавати CLI інформацію про активність користувача в реальному часі
(відкриті файли, позиція курсору, виділений текст).

## III. Інтерфейс перегляду змін (Diff)

Плагін повинен зареєструвати інструмент `openDiff`, який відкриває вікно
порівняння файлів в IDE. Користувач може переглядати та редагувати запропоновані
ШІ зміни безпосередньо в редакторі.

- `ide/diffAccepted`: Повідомлення про прийняття змін.
- `ide/diffRejected`: Повідомлення про відхилення змін.
